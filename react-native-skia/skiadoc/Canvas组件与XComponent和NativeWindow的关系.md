# Canvas ç»„ä»¶ä¸ XComponent å’Œ NativeWindow çš„å…³ç³»

## ğŸ“‹ é—®é¢˜

1. å¤šä¸ª Canvas ç»„ä»¶æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ
2. Canvas ç»„ä»¶è·Ÿ XComponent å’Œ NativeWindow çš„å…³ç³»æ˜¯ä»€ä¹ˆï¼Ÿ

## ğŸ¯ ç­”æ¡ˆ

**å…³ç³»é“¾ï¼š**
```
1 ä¸ª Canvas ç»„ä»¶ (React Native JS å±‚)
    â†“ ä¸€ä¸€å¯¹åº”
1 ä¸ª XComponent (ArkTS å±‚)
    â†“ ä¸€ä¸€å¯¹åº”
1 ä¸ª NativeWindow (ç³»ç»Ÿå±‚)
    â†“ ä¸€ä¸€å¯¹åº”
1 ä¸ª PluginRender å®ä¾‹ (C++ å±‚)
```

---

## 1. Canvas ç»„ä»¶æ˜¯ä»€ä¹ˆï¼Ÿ

### 1.1 Canvas ç»„ä»¶çš„å®šä¹‰

**Canvas æ˜¯ React Native JS å±‚çš„ç»„ä»¶ï¼š**

```typescript
// example/src/skia/index.tsx:431
<Canvas
  key={`calendar-${currentMonth.format('YYYY-MM')}-${rowCount}`}
  style={{
    width: '100%',
    height: gridHeight,
  }}>
  {/* ç»˜åˆ¶å†…å®¹ */}
</Canvas>
```

**Canvas ç»„ä»¶çš„ä½œç”¨ï¼š**
- åœ¨ React Native ä¸­å£°æ˜ä¸€ä¸ª Skia ç”»å¸ƒ
- æä¾›ç»˜åˆ¶æ¥å£ï¼ˆGroup, Text, Circle ç­‰ï¼‰
- é€šè¿‡ JSI è°ƒç”¨ C++ å±‚

### 1.2 Canvas ç»„ä»¶çš„æ¥æº

**Canvas æ¥è‡ª `@shopify/react-native-skia` åº“ï¼š**

```typescript
import {Canvas, Group, Text, Circle} from '@shopify/react-native-skia';
```

**Canvas æ˜¯ React Native ç»„ä»¶ï¼š**
- åœ¨ JS å±‚ä½¿ç”¨
- åœ¨ React ç»„ä»¶æ ‘ä¸­
- ç”¨æˆ·å¯ä»¥ç›´æ¥ä½¿ç”¨

---

## 2. å¤šä¸ª Canvas ç»„ä»¶æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ

### 2.1 å®é™…åœºæ™¯

**åœºæ™¯ï¼šé¡µé¢ä¸Šæœ‰å¤šä¸ª Canvas ç»„ä»¶**

```typescript
// é¡µé¢å¯èƒ½æœ‰å¤šä¸ª Canvas
function MyApp() {
  return (
    <View>
      {/* Canvas 1 - æ—¥å† */}
      <Canvas style={{width: 300, height: 400}}>
        {/* ç»˜åˆ¶æ—¥å† */}
      </Canvas>
      
      {/* Canvas 2 - å›¾è¡¨ */}
      <Canvas style={{width: 200, height: 200}}>
        {/* ç»˜åˆ¶å›¾è¡¨ */}
      </Canvas>
      
      {/* Canvas 3 - åŠ¨ç”» */}
      <Canvas style={{width: 100, height: 100}}>
        {/* ç»˜åˆ¶åŠ¨ç”» */}
      </Canvas>
    </View>
  );
}
```

**æ¯ä¸ª Canvas ç»„ä»¶ï¼š**
- ç‹¬ç«‹çš„ç»˜åˆ¶åŒºåŸŸ
- ç‹¬ç«‹çš„ç”Ÿå‘½å‘¨æœŸ
- ç‹¬ç«‹çš„æ¸²æŸ“å¾ªç¯

### 2.2 ä¸ºä»€ä¹ˆéœ€è¦å¤šä¸ª Canvasï¼Ÿ

**åŸå› ï¼š**
1. **ä¸åŒçš„å†…å®¹**ï¼šæ—¥å†ã€å›¾è¡¨ã€åŠ¨ç”»ç­‰
2. **ä¸åŒçš„å°ºå¯¸**ï¼šä¸åŒå¤§å°
3. **ç‹¬ç«‹çš„æ€§èƒ½**ï¼šäº’ä¸å½±å“
4. **ç‹¬ç«‹çš„ç”Ÿå‘½å‘¨æœŸ**ï¼šå¯ä»¥å•ç‹¬åˆ›å»º/é”€æ¯

---

## 3. Canvas ç»„ä»¶ä¸ XComponent çš„å…³ç³»

### 3.1 å…³ç³»é“¾

```
Canvas ç»„ä»¶ (React Native JS å±‚)
    â†“ RNOH æ¡¥æ¥
XComponent (ArkTS å±‚)
```

### 3.2 è¯¦ç»†æµç¨‹

**1. React Native æ¸²æŸ“ Canvas ç»„ä»¶ï¼š**
```typescript
// JS å±‚
<Canvas style={{width: 300, height: 400}}>
  {/* ç»˜åˆ¶å†…å®¹ */}
</Canvas>
```

**2. RNOH æ¡¥æ¥å±‚å¤„ç†ï¼š**
```
React Native JS å±‚
    â†“
RNOH æ¡¥æ¥å±‚
    â†“ åˆ›å»ºå¯¹åº”çš„ ArkTS ç»„ä»¶
ArkTS å±‚
```

**3. ArkTS å±‚åˆ›å»º XComponentï¼š**
```typescript
// SkiaDomView.ets:38
XComponent({
    id: X_COMPONENT_ID + "_" + this.nativeID,  // ä¾‹å¦‚ï¼š"SkiaDomView_123"
    type: XComponentType.SURFACE,
    libraryname: "rnoh_skia"
})
```

**4. å¯¹åº”å…³ç³»ï¼š**
```
Canvas ç»„ä»¶ (nativeID: 123)
    â†“ ä¸€ä¸€å¯¹åº”
XComponent (id: "SkiaDomView_123")
```

### 3.3 ä»£ç ä¸­çš„ä½“ç°

**Canvas ç»„ä»¶çš„ nativeIDï¼š**
```typescript
// React Native JS å±‚
<Canvas nativeID={123}>  // â† æ¯ä¸ª Canvas æœ‰å”¯ä¸€çš„ nativeID
  {/* ... */}
</Canvas>
```

**XComponent çš„ IDï¼š**
```typescript
// ArkTS å±‚
XComponent({
    id: "SkiaDomView_123"  // â† åŸºäº nativeID ç”Ÿæˆå”¯ä¸€ ID
})
```

**å…³ç³»ï¼š**
- 1 ä¸ª Canvas ç»„ä»¶ â†’ 1 ä¸ª nativeID
- 1 ä¸ª nativeID â†’ 1 ä¸ª XComponent ID
- å› æ­¤ï¼š1 ä¸ª Canvas ç»„ä»¶ â†’ 1 ä¸ª XComponent

---

## 4. XComponent ä¸ NativeWindow çš„å…³ç³»

### 4.1 å…³ç³»é“¾

```
XComponent (ArkTS å±‚)
    â†“ ç³»ç»Ÿåˆ›å»º
NativeWindow (ç³»ç»Ÿå±‚)
```

### 4.2 è¯¦ç»†æµç¨‹

**1. ArkTS åˆ›å»º XComponentï¼š**
```typescript
// SkiaDomView.ets:38
XComponent({
    type: XComponentType.SURFACE,  // â† å‘Šè¯‰ç³»ç»Ÿéœ€è¦åŸç”Ÿ Surface
    libraryname: "rnoh_skia"
})
```

**2. ç³»ç»Ÿåˆ›å»º NativeWindowï¼š**
```
XComponent åˆ›å»º
    â†“
ç³»ç»Ÿæ£€æµ‹åˆ° type: SURFACE
    â†“
ç³»ç»Ÿåˆ›å»º OHNativeWindow* (åŸç”Ÿçª—å£)
    â†“
é€šè¿‡ OnSurfaceCreated å›è°ƒä¼ é€’ç»™ C++
```

**3. å¯¹åº”å…³ç³»ï¼š**
```
XComponent (id: "SkiaDomView_123")
    â†“ ä¸€ä¸€å¯¹åº”
OHNativeWindow* (é€šè¿‡ OnSurfaceCreated è·å–)
```

### 4.3 ä»£ç ä¸­çš„ä½“ç°

**OnSurfaceCreated å›è°ƒï¼š**
```cpp
// plugin_render.cpp:43
void OnSurfaceCreatedCB(OH_NativeXComponent *component, void *window) {
    // 1. ä» component è·å– XComponent çš„ ID
    OH_NativeXComponent_GetXComponentId(component, idStr, &idSize);
    std::string id(idStr);  // â† "SkiaDomView_123"
    
    // 2. é€šè¿‡ ID è·å–å¯¹åº”çš„ PluginRender å®ä¾‹
    auto render = PluginRender::GetInstance(id);
    
    // 3. ä¿å­˜ NativeWindowï¼ˆä¸€ä¸ª XComponent å¯¹åº”ä¸€ä¸ª windowï¼‰
    render->m_window = static_cast<OHNativeWindow *>(window);
}
```

**å…³ç³»ï¼š**
- 1 ä¸ª XComponent â†’ 1 ä¸ª OH_NativeXComponent*
- 1 ä¸ª OH_NativeXComponent* â†’ 1 ä¸ª OHNativeWindow*
- å› æ­¤ï¼š1 ä¸ª XComponent â†’ 1 ä¸ª NativeWindow

---

## 5. å®Œæ•´å…³ç³»é“¾

### 5.1 å•ä¸ª Canvas çš„å…³ç³»é“¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  React Native JS å±‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Canvas ç»„ä»¶                                      â”‚ â”‚
â”‚  â”‚  nativeID: 123                                    â”‚ â”‚
â”‚  â”‚  style: {width: 300, height: 400}                â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â†“ RNOH æ¡¥æ¥
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ArkTS å±‚                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  XComponent                                       â”‚ â”‚
â”‚  â”‚  id: "SkiaDomView_123"                            â”‚ â”‚
â”‚  â”‚  type: SURFACE                                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â†“ ç³»ç»Ÿåˆ›å»º
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç³»ç»Ÿå±‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  OHNativeWindow*                                 â”‚ â”‚
â”‚  â”‚  (åŸç”Ÿçª—å£ï¼Œå¤§å°: 300x400)                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â†“ é€šè¿‡ ID ç®¡ç†
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  C++ å±‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  PluginRender å®ä¾‹                                â”‚ â”‚
â”‚  â”‚  id: "SkiaDomView_123"                            â”‚ â”‚
â”‚  â”‚  m_window: OHNativeWindow*                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 å¤šä¸ª Canvas çš„å…³ç³»é“¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  React Native JS å±‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Canvas 1     â”‚  â”‚ Canvas 2     â”‚  â”‚ Canvas 3     â”‚  â”‚
â”‚  â”‚ nativeID:123 â”‚  â”‚ nativeID:456 â”‚  â”‚ nativeID:789 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“                  â†“                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ArkTS å±‚                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ XComponent 1 â”‚  â”‚ XComponent 2 â”‚  â”‚ XComponent 3 â”‚  â”‚
â”‚  â”‚ id: "123"    â”‚  â”‚ id: "456"    â”‚  â”‚ id: "789"    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“                  â†“                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç³»ç»Ÿå±‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ NativeWin 1  â”‚  â”‚ NativeWin 2  â”‚  â”‚ NativeWin 3  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“                  â†“                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  C++ å±‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ PluginRender â”‚  â”‚ PluginRender â”‚  â”‚ PluginRender â”‚  â”‚
â”‚  â”‚ å®ä¾‹ 1       â”‚  â”‚ å®ä¾‹ 2       â”‚  â”‚ å®ä¾‹ 3       â”‚  â”‚
â”‚  â”‚ id: "123"    â”‚  â”‚ id: "456"    â”‚  â”‚ id: "789"    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. ä¸ºä»€ä¹ˆéœ€è¦ä¸€ä¸€å¯¹åº”ï¼Ÿ

### 6.1 ç‹¬ç«‹æ€§

**æ¯ä¸ª Canvas éœ€è¦ï¼š**
- ç‹¬ç«‹çš„ç»˜åˆ¶åŒºåŸŸ
- ç‹¬ç«‹çš„ç”Ÿå‘½å‘¨æœŸ
- ç‹¬ç«‹çš„æ¸²æŸ“å¾ªç¯
- ç‹¬ç«‹çš„èµ„æºç®¡ç†

**å¦‚æœä¸å¯¹åº”ï¼š**
- âŒ æ— æ³•åŒºåˆ†ä¸åŒçš„ Canvas
- âŒ å›è°ƒæ— æ³•æ­£ç¡®åˆ†å‘
- âŒ èµ„æºç®¡ç†æ··ä¹±

### 6.2 èµ„æºç®¡ç†

**æ¯ä¸ª Canvas æœ‰è‡ªå·±çš„èµ„æºï¼š**
```
Canvas 1
â”œâ”€ XComponent 1
â”œâ”€ NativeWindow 1
â”œâ”€ Surface 1
â”œâ”€ View 1
â””â”€ èµ„æº 1

Canvas 2
â”œâ”€ XComponent 2
â”œâ”€ NativeWindow 2
â”œâ”€ Surface 2
â”œâ”€ View 2
â””â”€ èµ„æº 2
```

**å¦‚æœä¸å¯¹åº”ï¼š**
- âŒ èµ„æºæ— æ³•æ­£ç¡®ç®¡ç†
- âŒ é”€æ¯æ—¶æ— æ³•æ­£ç¡®æ¸…ç†
- âŒ å†…å­˜æ³„æ¼

### 6.3 æ€§èƒ½

**æ¯ä¸ª Canvas ç‹¬ç«‹æ¸²æŸ“ï¼š**
- äº’ä¸å½±å“
- å¯ä»¥å•ç‹¬ä¼˜åŒ–
- å¯ä»¥å•ç‹¬æ§åˆ¶å¸§ç‡

**å¦‚æœä¸å¯¹åº”ï¼š**
- âŒ æ¸²æŸ“æ··ä¹±
- âŒ æ€§èƒ½é—®é¢˜
- âŒ éš¾ä»¥ä¼˜åŒ–

---

## 7. å®é™…ä¾‹å­

### 7.1 å•ä¸ª Canvas

```
é¡µé¢ï¼šæ—¥å†åº”ç”¨

Canvas ç»„ä»¶ (nativeID: 123)
    â†“ ä¸€ä¸€å¯¹åº”
XComponent (id: "SkiaDomView_123")
    â†“ ä¸€ä¸€å¯¹åº”
NativeWindow (é€šè¿‡ OnSurfaceCreated è·å–)
    â†“ ä¸€ä¸€å¯¹åº”
PluginRender å®ä¾‹ (id: "SkiaDomView_123")
```

### 7.2 å¤šä¸ª Canvas

```
é¡µé¢ï¼šä»ªè¡¨ç›˜åº”ç”¨

Canvas 1 (nativeID: 123) - æ—¥å†
    â†“
XComponent 1 (id: "SkiaDomView_123")
    â†“
NativeWindow 1
    â†“
PluginRender å®ä¾‹ 1

Canvas 2 (nativeID: 456) - å›¾è¡¨
    â†“
XComponent 2 (id: "SkiaDomView_456")
    â†“
NativeWindow 2
    â†“
PluginRender å®ä¾‹ 2

Canvas 3 (nativeID: 789) - åŠ¨ç”»
    â†“
XComponent 3 (id: "SkiaDomView_789")
    â†“
NativeWindow 3
    â†“
PluginRender å®ä¾‹ 3
```

---

## 8. æ€»ç»“

### 8.1 å…³ç³»é“¾

```
1 ä¸ª Canvas ç»„ä»¶ (React Native JS å±‚)
    â†“ ä¸€ä¸€å¯¹åº”
1 ä¸ª XComponent (ArkTS å±‚)
    â†“ ä¸€ä¸€å¯¹åº”
1 ä¸ª NativeWindow (ç³»ç»Ÿå±‚)
    â†“ ä¸€ä¸€å¯¹åº”
1 ä¸ª PluginRender å®ä¾‹ (C++ å±‚)
```

### 8.2 å…³é”®ç†è§£

1. **Canvas ç»„ä»¶** = React Native JS å±‚çš„ç»„ä»¶ï¼ˆç”¨æˆ·ç›´æ¥ä½¿ç”¨ï¼‰
2. **XComponent** = ArkTS å±‚çš„ UI å®¹å™¨ï¼ˆæ¡¥æ¥ JS å’Œ C++ï¼‰
3. **NativeWindow** = ç³»ç»Ÿå±‚çš„åŸç”Ÿçª—å£ï¼ˆçœŸæ­£çš„ç”»å¸ƒï¼‰
4. **PluginRender** = C++ å±‚çš„ç®¡ç†å™¨ï¼ˆç®¡ç†å®ä¾‹å’Œå›è°ƒï¼‰

### 8.3 å¤šä¸ª Canvas çš„å«ä¹‰

**å¤šä¸ª Canvas ç»„ä»¶ = é¡µé¢ä¸Šæœ‰å¤šä¸ªç‹¬ç«‹çš„ç»˜åˆ¶åŒºåŸŸ**

**æ¯ä¸ª Canvasï¼š**
- ç‹¬ç«‹çš„ XComponent
- ç‹¬ç«‹çš„ NativeWindow
- ç‹¬ç«‹çš„ PluginRender å®ä¾‹
- ç‹¬ç«‹çš„ç”Ÿå‘½å‘¨æœŸå’Œèµ„æº

### 8.4 ä¸ºä»€ä¹ˆéœ€è¦ä¸€ä¸€å¯¹åº”ï¼Ÿ

1. **ç‹¬ç«‹æ€§**ï¼šæ¯ä¸ª Canvas éœ€è¦ç‹¬ç«‹çš„ç»˜åˆ¶åŒºåŸŸå’Œç”Ÿå‘½å‘¨æœŸ
2. **èµ„æºç®¡ç†**ï¼šæ¯ä¸ª Canvas éœ€è¦ç‹¬ç«‹çš„èµ„æºç®¡ç†
3. **æ€§èƒ½**ï¼šæ¯ä¸ª Canvas å¯ä»¥ç‹¬ç«‹æ¸²æŸ“å’Œä¼˜åŒ–

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**æœ€åæ›´æ–°**: 2025-01-XX  
**ç»´æŠ¤è€…**: AI Assistant
